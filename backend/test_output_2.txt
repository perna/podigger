============================= test session starts ==============================
platform linux -- Python 3.12.7, pytest-9.0.1, pluggy-1.6.0 -- /home/perna/workspace/projects/podigger/backend/.venv/bin/python
cachedir: .pytest_cache
django: version: 5.2.8, settings: config.settings (from env)
rootdir: /home/perna/workspace/projects/podigger/backend
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: django-4.11.1, mock-3.15.1, Faker-19.9.0
collecting ... collected 7 items

podcasts/tests/test_updater.py::test_updater_updates_total_episodes FAILED [ 14%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_create_podcast FAILED [ 28%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_create_duplicate_podcast FAILED [ 42%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_recent_podcasts PASSED [ 57%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_search_podcast PASSED [ 71%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_search_episodes_saves_term PASSED [ 85%]
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_create_podcast_validates_feed PASSED [100%]

=================================== FAILURES ===================================
_____________________ test_updater_updates_total_episodes ______________________
podcasts/tests/test_updater.py:44: in test_updater_updates_total_episodes
    assert Episode.objects.count() == 2
E   assert 0 == 2
E    +  where 0 = count()
E    +    where count = <django.db.models.manager.Manager object at 0x7cb7ed7ba090>.count
E    +      where <django.db.models.manager.Manager object at 0x7cb7ed7ba090> = Episode.objects
---------------------------- Captured stderr setup -----------------------------
Creating test database for alias 'default'...
------------------------------ Captured log call -------------------------------
ERROR    podcasts.services.updater:updater.py:87 Falha ao processar o feed http://test.com/feed: ['“Fri, 01 Jan 2023 10:00:00 GMT” value has an invalid format. It must be in YYYY-MM-DD HH:MM[:ss[.uuuuuu]][TZ] format.']
________________ TestPodcastViewSetFeatures.test_create_podcast ________________
podcasts/tests/test_views_features.py:22: in test_create_podcast
    assert response.status_code == 201
E   assert 400 == 201
E    +  where 400 = <Response status_code=400, "application/json">.status_code
------------------------------ Captured log call -------------------------------
WARNING  django.request:log.py:253 Bad Request: /api/podcasts/
___________ TestPodcastViewSetFeatures.test_create_duplicate_podcast ___________
podcasts/tests/test_views_features.py:31: in test_create_duplicate_podcast
    assert response.status_code == 200
E   assert 400 == 200
E    +  where 400 = <Response status_code=400, "application/json">.status_code
------------------------------ Captured log call -------------------------------
WARNING  django.request:log.py:253 Bad Request: /api/podcasts/
=============================== warnings summary ===============================
podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_search_episodes_saves_term
  /home/perna/workspace/projects/podigger/backend/.venv/lib/python3.12/site-packages/django/db/models/fields/__init__.py:1671: RuntimeWarning: DateTimeField Episode.published received a naive datetime (2023-01-01 00:00:00) while time zone support is active.
    warnings.warn(

.venv/lib/python3.12/site-packages/_pytest/cacheprovider.py:475
  /home/perna/workspace/projects/podigger/backend/.venv/lib/python3.12/site-packages/_pytest/cacheprovider.py:475: PytestCacheWarning: cache could not write path /home/perna/workspace/projects/podigger/backend/.pytest_cache/v/cache/nodeids: [Errno 13] Permission denied: '/home/perna/workspace/projects/podigger/backend/.pytest_cache/v/cache/nodeids'
    config.cache.set("cache/nodeids", sorted(self.cached_nodeids))

.venv/lib/python3.12/site-packages/_pytest/cacheprovider.py:429
  /home/perna/workspace/projects/podigger/backend/.venv/lib/python3.12/site-packages/_pytest/cacheprovider.py:429: PytestCacheWarning: cache could not write path /home/perna/workspace/projects/podigger/backend/.pytest_cache/v/cache/lastfailed: [Errno 13] Permission denied: '/home/perna/workspace/projects/podigger/backend/.pytest_cache/v/cache/lastfailed'
    config.cache.set("cache/lastfailed", self.lastfailed)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED podcasts/tests/test_updater.py::test_updater_updates_total_episodes - ...
FAILED podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_create_podcast
FAILED podcasts/tests/test_views_features.py::TestPodcastViewSetFeatures::test_create_duplicate_podcast
=================== 3 failed, 4 passed, 3 warnings in 5.99s ====================
